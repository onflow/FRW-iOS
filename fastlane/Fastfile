default_platform(:ios)

platform :ios do

  before_all do
    # ✅ Use modern CircleCI setup
    setup_ci if is_ci
  end

  desc "Push a new release build to the App Store"
  lane :release do
    build
    upload_to_testflight
  end
   
  private_lane :build do
    increment_build_number()
    match(type:'appstore', readonly: is_ci)
    build_app(
      scheme: "FRW",
      export_method: 'app-store',
      include_bitcode: false,
      clean: true
    )
  end

  # ✅ Remove problematic lanes that reference non-existent actions
  private_lane :update_app_name do
    app_name = "Flow wallet"

    set_info_plist_value(
      app_identifier: "com.flowfoundation.wallet",
      key: "CFBundleDisplayName",
      value: app_name
    )
  end

end

